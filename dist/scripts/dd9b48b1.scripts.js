"use strict";angular.module("Gallery",["Gallery.templates","ngRoute"]).config(["$routeProvider",function($routeProvider){$routeProvider.when("/",{templateUrl:"views/home.html",controller:"homeCtrl"}).when("/pictures",{templateUrl:"views/pictures.html",controller:"picturesCtrl"}).when("/collages",{templateUrl:"views/collages.html",controller:"collagesCtrl"}).when("/drawings",{templateUrl:"views/drawings.html",controller:"drawingsCtrl"}).when("/contact",{templateUrl:"views/contact.html",controller:"contactCtrl"}).otherwise({redirectTo:"/"})}]),angular.module("Gallery").constant("imageData",function(){return{collages:["images/collages/001.jpg","images/collages/002.jpg","images/collages/003.jpg","images/collages/004.jpg","images/collages/005.jpg","images/collages/006.jpg","images/collages/007.jpg","images/collages/008.jpg","images/collages/009.jpg","images/collages/010.jpg","images/collages/011.jpg","images/collages/012.jpg","images/collages/013.jpg","images/collages/014.jpg","images/collages/015.jpg","images/collages/016.jpg","images/collages/017.jpg","images/collages/018.jpg","images/collages/019.jpg","images/collages/020.jpg","images/collages/021.jpg","images/collages/022.jpg","images/collages/023.jpg","images/collages/024.jpg","images/collages/025.jpg","images/collages/026.jpg","images/collages/027.jpg","images/collages/028.jpg","images/collages/029.jpg","images/collages/030.jpg","images/collages/031.jpg","images/collages/032.jpg","images/collages/033.jpg","images/collages/034.jpg","images/collages/035.jpg","images/collages/036.jpg","images/collages/037.jpg","images/collages/038.jpg","images/collages/039.jpg","images/collages/040.jpg","images/collages/041.jpg","images/collages/042.jpg","images/collages/043.jpg","images/collages/044.jpg","images/collages/045.jpg","images/collages/046.jpg","images/collages/047.jpg","images/collages/048.jpg","images/collages/049.jpg","images/collages/050.jpg","images/collages/051.jpg","images/collages/052.jpg","images/collages/053.jpg","images/collages/054.jpg","images/collages/055.jpg","images/collages/056.jpg","images/collages/057.jpg","images/collages/058.jpg","images/collages/059.jpg","images/collages/060.jpg","images/collages/061.jpg","images/collages/062.jpg","images/collages/063.jpg","images/collages/064.jpg","images/collages/065.jpg","images/collages/066.jpg","images/collages/067.jpg","images/collages/068.jpg","images/collages/069.jpg","images/collages/070.jpg","images/collages/071.jpg","images/collages/100.jpg","images/collages/101.jpg","images/collages/102.jpg","images/collages/103.jpg","images/collages/104.jpg","images/collages/105.jpg","images/collages/106.jpg","images/collages/107.jpg","images/collages/108.jpg","images/collages/109.jpg","images/collages/110.jpg","images/collages/111.jpg","images/collages/112.jpg","images/collages/113.jpg","images/collages/114.jpg","images/collages/115.jpg","images/collages/116.jpg","images/collages/117.jpg","images/collages/118.jpg","images/collages/119.jpg","images/collages/120.jpg","images/collages/121.jpg","images/collages/122.jpg","images/collages/123.jpg","images/collages/124.jpg","images/collages/125.jpg","images/collages/126.jpg","images/collages/127.jpg","images/collages/128.jpg","images/collages/129.jpg","images/collages/130.jpg","images/collages/131.jpg","images/collages/132.jpg","images/collages/133.jpg","images/collages/134.jpg","images/collages/135.jpg","images/collages/136.jpg","images/collages/137.jpg","images/collages/138.jpg","images/collages/139.jpg","images/collages/140.jpg","images/collages/141.jpg","images/collages/142.jpg","images/collages/143.jpg","images/collages/144.jpg","images/collages/145.jpg","images/collages/146.jpg","images/collages/147.jpg","images/collages/148.jpg","images/collages/72.jpg","images/collages/73.jpg","images/collages/74.jpg","images/collages/75.jpg","images/collages/76.jpg","images/collages/77.jpg","images/collages/78.jpg","images/collages/79.jpg","images/collages/80.jpg","images/collages/81.jpg","images/collages/82.jpg","images/collages/83.jpg","images/collages/84.jpg","images/collages/85.jpg","images/collages/86.jpg","images/collages/87.jpg","images/collages/88.jpg","images/collages/89.jpg","images/collages/90.jpg","images/collages/91.jpg","images/collages/92.jpg","images/collages/93.jpg","images/collages/94.jpg","images/collages/95.jpg","images/collages/96.jpg","images/collages/97.jpg","images/collages/98.jpg","images/collages/99.jpg"],drawings:["images/drawings/1.jpg","images/drawings/10.jpg","images/drawings/11.jpg","images/drawings/12.jpg","images/drawings/13.jpg","images/drawings/14.jpg","images/drawings/15.jpg","images/drawings/16.jpg","images/drawings/17.jpg","images/drawings/18.jpg","images/drawings/19.jpg","images/drawings/2.jpg","images/drawings/20.jpg","images/drawings/21.jpg","images/drawings/22.jpg","images/drawings/23.jpg","images/drawings/24.jpg","images/drawings/25.jpg","images/drawings/26.jpg","images/drawings/27.jpg","images/drawings/28.jpg","images/drawings/29.jpg","images/drawings/3.jpg","images/drawings/30.jpg","images/drawings/31.jpg","images/drawings/32.jpg","images/drawings/33.jpg","images/drawings/34.jpg","images/drawings/35.jpg","images/drawings/36.jpg","images/drawings/37.jpg","images/drawings/38.jpg","images/drawings/39.jpg","images/drawings/4.jpg","images/drawings/40.jpg","images/drawings/41.jpg","images/drawings/42.jpg","images/drawings/43.jpg","images/drawings/44.jpg","images/drawings/45.jpg","images/drawings/46.jpg","images/drawings/47.jpg","images/drawings/48.jpg","images/drawings/49.jpg","images/drawings/5.jpg","images/drawings/50.jpg","images/drawings/51.jpg","images/drawings/52.jpg","images/drawings/53.jpg","images/drawings/54.jpg","images/drawings/55.jpg","images/drawings/56.jpg","images/drawings/57.jpg","images/drawings/58.jpg","images/drawings/59.jpg","images/drawings/6.jpg","images/drawings/60.jpg","images/drawings/61.jpg","images/drawings/62.jpg","images/drawings/63.jpg","images/drawings/64.jpg","images/drawings/65.jpg","images/drawings/66.jpg","images/drawings/67.jpg","images/drawings/68.jpg","images/drawings/69.jpg","images/drawings/7.jpg","images/drawings/70.jpg","images/drawings/71.jpg","images/drawings/72.jpg","images/drawings/73.jpg","images/drawings/74.jpg","images/drawings/8.jpg","images/drawings/9.jpg"],pictures:["images/pictures/1.jpg","images/pictures/10.jpg","images/pictures/100.jpg","images/pictures/101.jpg","images/pictures/11.jpg","images/pictures/12.jpg","images/pictures/13.jpg","images/pictures/14.jpg","images/pictures/15.jpg","images/pictures/16.jpg","images/pictures/17.jpg","images/pictures/18.jpg","images/pictures/19.jpg","images/pictures/2.jpg","images/pictures/20.jpg","images/pictures/21.jpg","images/pictures/22.jpg","images/pictures/23.jpg","images/pictures/24.jpg","images/pictures/25.jpg","images/pictures/26.jpg","images/pictures/27.jpg","images/pictures/28.jpg","images/pictures/29.jpg","images/pictures/3.jpg","images/pictures/30.jpg","images/pictures/31.jpg","images/pictures/32.jpg","images/pictures/33.jpg","images/pictures/34.jpg","images/pictures/35.jpg","images/pictures/36.jpg","images/pictures/37.jpg","images/pictures/38.jpg","images/pictures/39.jpg","images/pictures/4.jpg","images/pictures/40.jpg","images/pictures/41.jpg","images/pictures/42.jpg","images/pictures/43.jpg","images/pictures/44.jpg","images/pictures/45.jpg","images/pictures/46.jpg","images/pictures/47.jpg","images/pictures/48.jpg","images/pictures/49.jpg","images/pictures/5.jpg","images/pictures/50.jpg","images/pictures/51.jpg","images/pictures/52.jpg","images/pictures/53.jpg","images/pictures/54.jpg","images/pictures/55.jpg","images/pictures/56.jpg","images/pictures/57.jpg","images/pictures/58.jpg","images/pictures/59.jpg","images/pictures/6.jpg","images/pictures/60.jpg","images/pictures/61.jpg","images/pictures/62.jpg","images/pictures/63.jpg","images/pictures/64.jpg","images/pictures/65.jpg","images/pictures/66.jpg","images/pictures/67.jpg","images/pictures/68.jpg","images/pictures/69.jpg","images/pictures/7.jpg","images/pictures/70.jpg","images/pictures/71.jpg","images/pictures/72.jpg","images/pictures/73.jpg","images/pictures/74.jpg","images/pictures/75.jpg","images/pictures/76.jpg","images/pictures/77.jpg","images/pictures/78.jpg","images/pictures/79.jpg","images/pictures/8.jpg","images/pictures/80.jpg","images/pictures/81.jpg","images/pictures/82.jpg","images/pictures/83.jpg","images/pictures/84.jpg","images/pictures/85.jpg","images/pictures/86.jpg","images/pictures/87.jpg","images/pictures/88.jpg","images/pictures/89.jpg","images/pictures/9.jpg","images/pictures/90.jpg","images/pictures/91.jpg","images/pictures/92.jpg","images/pictures/93.jpg","images/pictures/94.jpg","images/pictures/95.jpg","images/pictures/96.jpg","images/pictures/97.jpg","images/pictures/98.jpg","images/pictures/99.jpg"]}}()),angular.module("Gallery").controller("collagesCtrl",function(){}),angular.module("Gallery").controller("contactCtrl",function(){}),angular.module("Gallery").controller("drawingsCtrl",function(){}),angular.module("Gallery").controller("homeCtrl",["$scope","imageData",function($scope,imageData){function randomSlice(array){var start=Math.floor(Math.random()*(array.length-maxPerList)),end=start+maxPerList;return array.slice(start,end)}function shuffleArray(array){for(var i=array.length-1;i>0;i--){var j=Math.floor(Math.random()*(i+1)),temp=array[i];array[i]=array[j],array[j]=temp}return array}var maxPerList=10;$scope.images=shuffleArray(randomSlice(imageData.collages).concat(randomSlice(imageData.drawings)).concat(randomSlice(imageData.pictures)))}]),angular.module("Gallery").controller("picturesCtrl",["$scope","imageData",function($scope,imageData){$scope.images=imageData.pictures}]),angular.module("Gallery").directive("card",["zIndexService","fifoAnimationService",function(zIndexService,fifoAnimationService){function randomCoordinates(){var x=Math.floor(Math.random()*(screenWidth-cardSize)),y=Math.floor(Math.random()*(screenHeight-cardSize)),rotation=Math.floor(61*Math.random())-30;return{x:x,y:y,rotation:rotation}}function getVendorTransformPrefix(){var nav=navigator.userAgent;return/Firefox[\/\s](\d+\.\d+)/.test(nav)?"-moz-transform":/MSIE (\d+\.\d+);/.test(nav)?"-ms-transform":/Opera[\/\s](\d+\.\d+)/.test(nav)?"-o-transform":/Safari[\/\s](\d+\.\d+)/.test(nav)?"-webkit-transform":"transform"}var screenWidth=window.innerWidth,screenHeight=window.innerHeight,cardSize=200;return{restrict:"E",replace:!0,templateUrl:"views/directives/card.html",scope:{image:"="},link:{pre:function($scope,element){var coords=randomCoordinates(),screenHeight=window.innerHeight,cssVendor=getVendorTransformPrefix();element.css("top",screenHeight+"px"),element.css("z-index",zIndexService.getZ());var animation=new TWEEN.Tween({top:screenHeight,left:0,deg:0}).to({top:coords.y,left:coords.x,deg:coords.rotation},150).easing(TWEEN.Easing.Exponential.Out).onUpdate(function(){element.css("top",this.top+"px"),element.css("left",this.left+"px"),element.css(cssVendor,"rotate("+this.deg+"deg)")});fifoAnimationService.put(animation)},post:function($scope,element){var dragImage=angular.element(element.children()[0]).clone();element.on("dragstart",function(e){dragImage.css("z-index",zIndexService.getZ()),e.dataTransfer.setDragImage(dragImage[0],cardSize,cardSize),element.css("opacity",0)}),element.on("dragend",function(e){element.css("top",e.layerY+"px"),element.css("left",e.layerX+"px"),element.css("opacity",1)})}}}}]),angular.module("Gallery").service("zIndexService",function(){var zIndex=0;return{getZ:function(){return++zIndex}}}),angular.module("Gallery").directive("slider",["fifoAnimationService","sliderImagesLoading",function(fifoAnimationService,sliderImagesLoading){return{restrict:"E",replace:!0,templateUrl:"views/directives/slider.html",scope:{images:"="},link:{pre:function($scope){sliderImagesLoading.init($scope.images.length)},post:function($scope){function containerCalibration(){minContainerX=window.innerWidth/2-imageBlockHalfWidth,maxContainerX=-(containerWidth-window.innerWidth/2-imageBlockHalfWidth),container.css("left",minContainerX+"px")}function cursorCalibration(){var current=cursor.css("left");cursor.css("left",""),cursor.css("right","25%");var cursorRect=cursor[0].getBoundingClientRect();maxCursorX=cursorRect.left+cursorRect.width/2,cursor.css("right",""),cursor.css("left","25%"),cursorRect=cursor[0].getBoundingClientRect(),minCursorX=cursorRect.left,cursorCurrentX=minCursorX,cursor.css("left",current||minCursorX/window.innerWidth*100+"%")}function setCursorPosition(x){x>maxCursorX?x=maxCursorX:minCursorX>x&&(x=minCursorX),cursor.css("left",x/window.innerWidth*100+"%"),cursorCurrentX=x,moveContainer(x)}function moveContainer(x){container.css("left",x*coeffA+coeffB+"px")}function ratioCalibration(){coeffB=(minContainerX*maxCursorX+-maxContainerX*minCursorX)/(maxCursorX-minCursorX),coeffA=(minContainerX-coeffB)/minCursorX}var container=angular.element(document.getElementById("sliderContainer")),imageWidth=500,imageMargin=50,imageBlockWidth=imageWidth+2*imageMargin,imageBlockHalfWidth=imageBlockWidth/2,containerWidth=$scope.images.length*imageBlockWidth,maxContainerX=0,minContainerX=0;container.css("width",containerWidth+"px"),containerCalibration();var cursor=angular.element(document.getElementById("sliderCursor")),maxCursorX=0,minCursorX=0,cursorCurrentX=0;cursorCalibration();var navigation=angular.element(document.getElementById("sliderNavigation")),cursorHalfSize=20,cursorSelected=!1;cursor.on("mousedown",function(){cursorSelected=!0}),window.onmouseup=function(){cursorSelected=!1},window.onmousemove=function(e){cursorSelected&&setCursorPosition(e.x-cursorHalfSize)},navigation.on("click",function(e){e.stopPropagation(),e.preventDefault();var animation=new TWEEN.Tween({x:cursorCurrentX}).to({x:e.x-cursorHalfSize},600).easing(TWEEN.Easing.Linear.None).onUpdate(function(){setCursorPosition(this.x)});fifoAnimationService.put(animation),fifoAnimationService.animate()}),window.onresize=function(){containerCalibration(),cursorCalibration(),ratioCalibration()};var coeffA=0,coeffB=0;ratioCalibration(),$scope.$on("sliderImagesLoaded",function(){console.log("allLoaded")})}}}}]),angular.module("Gallery").service("sliderImagesLoading",["$rootScope",function($rootScope){var loaded=0,toLoad=0;return{imageLoaded:function(){loaded++,loaded===toLoad&&$rootScope.$broadcast("sliderImagesLoaded")},init:function(nb){toLoad=nb}}}]),angular.module("Gallery").directive("notifyOnLoad",["sliderImagesLoading",function(sliderImagesLoading){return function($scope,element){element.on("load",function(){sliderImagesLoading.imageLoaded()})}}]),angular.module("Gallery").service("fifoAnimationService",function(){function updateAnimation(){running&&(window.requestAnimationFrame(updateAnimation),TWEEN.update())}var animations=[],running=!1;return{animate:function(){if(animations.length){var self=this,i=0;for(i;i<animations.length-1;i++)animations[i].chain(animations[i+1]);animations[i].onComplete(function(){self.clear()}),animations[0].start(),running=!0,updateAnimation()}},clear:function(){TWEEN.removeAll(),running=!1,animations=[]},put:function(animation){animations.push(animation)}}}),angular.module("Gallery").directive("animateOnEnd",["fifoAnimationService",function(fifoAnimationService){return function($scope){$scope.$last&&fifoAnimationService.animate()}}]),angular.module("Gallery.templates",["views/collages.html","views/contact.html","views/directives/card.html","views/directives/slider.html","views/drawings.html","views/home.html","views/navbar.html","views/pictures.html"]),angular.module("views/collages.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("views/collages.html","<span>Collage</span>")}]),angular.module("views/contact.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("views/contact.html","<span>Contact</span>")}]),angular.module("views/directives/card.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("views/directives/card.html","<div class=card draggable=true><img ng-src={{image}} class=card__image></div>")}]),angular.module("views/directives/slider.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("views/directives/slider.html",'<div class=slider><div class=slider__images><div id=sliderContainer class=slider__images__container><img ng-src={{image}} class=slider__images__container__image ng-repeat="image in images" notify-on-load=""></div></div><div id=sliderNavigation class=slider__navigation><div id=sliderCursor class=slider__navigation__cursor></div></div></div>')}]),angular.module("views/drawings.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("views/drawings.html","<span>Drawing</span>")}]),angular.module("views/home.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("views/home.html",'<card ng-repeat="image in images" image=image animate-on-end=""></card>')}]),angular.module("views/navbar.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("views/navbar.html",'<header class=navbar><div class=navbar__title>La galerie de Moussette</div><nav><ul class=navbar__actions><li class=navbar__actions__action><a href="#/" class=navbar__actions__action__link>Accueil</a></li><li class=navbar__actions__action><a href=#/pictures class=navbar__actions__action__link>Photos</a></li><li class=navbar__actions__action><a href=#/collages class=navbar__actions__action__link>Collages</a></li><li class=navbar__actions__action><a href=#/drawings class=navbar__actions__action__link>Dessins</a></li><li class=navbar__actions__action><a href=#/contact class=navbar__actions__action__link>Contact</a></li></ul></nav></header>')}]),angular.module("views/pictures.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("views/pictures.html","<slider images=images></slider>")}]);